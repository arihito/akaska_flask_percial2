{
  "permissions": {
    "allow": [
      "Bash(cd \"C:/Users/arihi/Dropbox/DevOps/Flask/Percial2/Memo\" && C:/Users/arihi/miniconda3/envs/flask2_env/python.exe -c \"\nimport py_compile, sys\nfiles = ['admin/views.py', 'utils/ai_translate_score.py', 'utils/ai_translate.py']\nfor f in files:\n    try:\n        py_compile.compile\\(f, doraise=True\\)\n        print\\(f'OK: {f}'\\)\n    except py_compile.PyCompileError as e:\n        print\\(f'NG: {f} -> {e}'\\)\n\" 2>&1)",
      "Bash(cd \"C:/Users/arihi/Dropbox/DevOps/Flask/Percial2/Memo\" && C:/Users/arihi/miniconda3/envs/flask2_env/python.exe -c \"\nfrom dotenv import load_dotenv\nload_dotenv\\(\\)\nimport os\nos.environ.setdefault\\('FLASK_DEBUG', '0'\\)\n\n# Flaskアプリ生成テスト\nfrom app import create_app\napp = create_app\\(\\)\n\n# テンプレートの構文チェック（jinja2でパース）\nfrom jinja2 import Environment, FileSystemLoader\nenv = Environment\\(loader=FileSystemLoader\\('templates'\\)\\)\n\nfiles = ['admin/marketing.j2', 'admin/sidemenu.j2']\nfor f in files:\n    try:\n        env.get_template\\(f\\)\n        print\\(f'OK: {f}'\\)\n    except Exception as e:\n        print\\(f'NG: {f} -> {e}'\\)\n\" 2>&1)",
      "Bash(cd \"C:/Users/arihi/Dropbox/DevOps/Flask/Percial2/Memo\" && C:/Users/arihi/miniconda3/envs/flask2_env/python.exe -c \"\nfrom jinja2 import Environment, FileSystemLoader\nenv = Environment\\(loader=FileSystemLoader\\('templates'\\)\\)\nfiles = ['admin/marketing.j2', 'admin/sidemenu.j2']\nfor f in files:\n    try:\n        env.get_template\\(f\\)\n        print\\(f'OK: {f}'\\)\n    except Exception as e:\n        print\\(f'NG: {f} -> {e}'\\)\n\" 2>&1)",
      "Bash(cd \"C:/Users/arihi/Dropbox/DevOps/Flask/Percial2/Memo\" && conda run -n flask2_env python -c \"\nimport sqlite3\nconn = sqlite3.connect\\('instance/memodb.sqlite'\\)\nc = conn.cursor\\(\\)\nc.execute\\('PRAGMA table_info\\(users\\)'\\)\ncols = [row[1] for row in c.fetchall\\(\\)]\nprint\\('カラム一覧:', cols\\)\nprint\\('suspend_requested追加済み:', 'suspend_requested' in cols\\)\nprint\\('suspend_reason追加済み:', 'suspend_reason' in cols\\)\nconn.close\\(\\)\n\" 2>&1)",
      "Bash(cd \"C:/Users/arihi/Dropbox/DevOps/Flask/Percial2/Memo\" && C:/Users/arihi/miniconda3/envs/flask2_env/python.exe -c \"\nimport os\nfrom dotenv import load_dotenv\nload_dotenv\\(\\)\napi_key = os.environ.get\\('GOOGLE_API_KEY', ''\\)\nprint\\('API KEY exists:', bool\\(api_key\\), '/ length:', len\\(api_key\\)\\)\n\nfrom google import genai\nfrom google.genai import types\nclient = genai.Client\\(api_key=api_key\\)\n\ntry:\n    response = client.models.generate_images\\(\n        model='imagen-3.0-generate-002',\n        prompt='flat vector illustration icon of an IT student with laptop',\n        config=types.GenerateImagesConfig\\(\n            number_of_images=1,\n            aspect_ratio='1:1',\n            output_mime_type='image/png',\n        \\),\n    \\)\n    print\\('SUCCESS: generated', len\\(response.generated_images\\), 'images'\\)\nexcept Exception as e:\n    print\\('ERROR:', type\\(e\\).__name__, str\\(e\\)\\)\n\" 2>&1)",
      "Bash(cd \"C:/Users/arihi/Dropbox/DevOps/Flask/Percial2/Memo\" && C:/Users/arihi/miniconda3/envs/flask2_env/python.exe -c \"\nimport os\nfrom dotenv import load_dotenv\nload_dotenv\\(\\)\napi_key = os.environ.get\\('GOOGLE_API_KEY', ''\\)\nfrom google import genai\nclient = genai.Client\\(api_key=api_key\\)\n\n# 画像生成対応モデルを探す\nmodels = client.models.list\\(\\)\nfor m in models:\n    name = m.name\n    if 'imagen' in name.lower\\(\\) or 'image' in name.lower\\(\\) or 'flash' in name.lower\\(\\):\n        print\\(name\\)\n\" 2>&1)",
      "Bash(cd \"C:/Users/arihi/Dropbox/DevOps/Flask/Percial2/Memo\" && C:/Users/arihi/miniconda3/envs/flask2_env/python.exe -c \"\nimport os\nfrom dotenv import load_dotenv\nload_dotenv\\(\\)\napi_key = os.environ.get\\('GOOGLE_API_KEY', ''\\)\n\nfrom google import genai\nfrom google.genai.types import GenerateContentConfig\n\nclient = genai.Client\\(api_key=api_key\\)\n\nprompt = \\(\n    'Flat vector illustration profile icon. '\n    'A young IT student developer with glasses sitting at a laptop computer and coding. '\n    'Circular composition with a vibrant solid colored background circle. '\n    'Flat design style, clean and minimal. '\n    'No text, no shadows, no gradients. '\n    'Square canvas, icon suitable for a profile picture.'\n\\)\n\nresponse = client.models.generate_content\\(\n    model='gemini-2.0-flash-exp-image-generation',\n    contents=prompt,\n    config=GenerateContentConfig\\(response_modalities=['IMAGE', 'TEXT']\\),\n\\)\n\nfor part in response.candidates[0].content.parts:\n    if part.inline_data is not None:\n        data = part.inline_data.data\n        print\\('SUCCESS: bytes =', len\\(data\\), '/ mime =', part.inline_data.mime_type\\)\n        with open\\('test_thumb.png', 'wb'\\) as f:\n            f.write\\(data\\)\n        print\\('Saved: test_thumb.png'\\)\n        break\nelse:\n    print\\('ERROR: no image in response'\\)\n\" 2>&1)",
      "Bash(cd \"C:/Users/arihi/Dropbox/DevOps/Flask/Percial2/Memo\" && C:/Users/arihi/miniconda3/envs/flask2_env/python.exe -c \"\nimport os, io\nfrom dotenv import load_dotenv\nload_dotenv\\(\\)\napi_key = os.environ.get\\('GOOGLE_API_KEY', ''\\)\n\nfrom google import genai\nfrom google.genai.types import GenerateContentConfig\nfrom PIL import Image, ImageDraw\n\nclient = genai.Client\\(api_key=api_key\\)\nprompt = \\(\n    'Flat vector illustration profile icon. '\n    'A young IT student developer with glasses sitting at a laptop computer and coding. '\n    'Circular composition with a vibrant solid colored background circle. '\n    'Flat design style, clean and minimal. No text, no shadows. Square canvas.'\n\\)\nresponse = client.models.generate_content\\(\n    model='gemini-2.0-flash-exp-image-generation',\n    contents=prompt,\n    config=GenerateContentConfig\\(response_modalities=['IMAGE', 'TEXT']\\),\n\\)\nraw = None\nfor part in response.candidates[0].content.parts:\n    if part.inline_data is not None:\n        raw = part.inline_data.data\n        break\n\n# 円形マスク適用\nimg = Image.open\\(io.BytesIO\\(raw\\)\\).convert\\('RGBA'\\)\nsize = min\\(img.size\\)\nimg = img.crop\\(\\(\\(img.width-size\\)//2, \\(img.height-size\\)//2, \\(img.width+size\\)//2, \\(img.height+size\\)//2\\)\\)\nimg = img.resize\\(\\(512, 512\\), Image.LANCZOS\\)\nmask = Image.new\\('L', img.size, 0\\)\ndraw = ImageDraw.Draw\\(mask\\)\ndraw.ellipse\\(\\(0, 0, 511, 511\\), fill=255\\)\nimg.putalpha\\(mask\\)\nimg.save\\('test_thumb.png', format='PNG'\\)\nprint\\('mode:', img.mode, '/ size:', img.size, '/ alpha:', img.getchannel\\('A'\\).getextrema\\(\\)\\)\n\" 2>&1)"
    ]
  }
}

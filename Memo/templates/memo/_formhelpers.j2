{% macro render_field(field, placeholder=None, wrapper_class="", input_class="", attrs=None) %}
    {% if attrs is none %}
        {% set attrs = {} %}
    {% endif %}

    {# form-controlを必ず含め、追加クラスを安全に連結 #}
    {% set merged_class = "form-control " ~ input_class ~ " " ~ attrs.get("class", "") %}

    <div class="form-floating mb-3 {{ wrapper_class }}">
        {{ field(
            class=merged_class|trim,
            placeholder=placeholder if placeholder else field.label.text,
            id=field.id,
            **attrs
        ) }}
        <label for="{{ field.id }}">{{ field.label.text }}</label>

        {% if field.errors %}
            <div class="alert alert-danger small mt-1">
                <i class="fa fa-exclamation-triangle"></i>
                {% for error in field.errors %}{{ error }}{% endfor %}
            </div>
        {% endif %}
    </div>
{% endmacro %}

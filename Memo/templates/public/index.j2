{% extends "base.j2" %}
{% block content %}
    <div class="mb-4 rounded key_visual"></div>
    <div class="row">
        <div class="col-md-9">
            {% if top1 %}
                <div class="card rounded shadow recommend">
                    <div class="row g-0 h-100">
                        <div class="col-md-8">
                            <div class="card-body p-4">
                                <h3 class="pb-4 mb-4 fst-italic border-bottom">
                                    <i class="fa fa-calendar-o"></i>‰ªäÈÄ±„ÅÆ„Ç™„Çπ„Çπ„É°Ë®ò‰∫ã
                                </h3>
                                <h2 class="card-title display-6 link-body-emphasis mb-1">{{ top1.memo.title }}</h2>
                                <p class="blog-post-meta">
                                    {{ top1.memo.created_at.strftime("%Y-%m-%d") }} by {{ top1.memo.user.username }}‚ù§Ô∏è {{ top1.like_count }} „ÅÑ„ÅÑ„Å≠
                                </p>
                                <p class="card-text">{{ top1.memo.content }}</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="h-100">
                                <img class="w-100 h-100 rounded-end"
                                     src="{{ url_for('static', filename='images/memo/' ~ top1.memo.image_filename) }}"
                                     width="100"
                                     height=""
                                     alt="Ë®ò‰∫ãÁîªÂÉè"
                                     style="object-fit: cover">
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
            <div class="row mt-3">
                {% for row in memos %}
                    {% set memo = row.memo %}
                    {% set like_count = row.like_count %}
                    <div class="col-md-6">
                        <div class="text-white-50 row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-300 position-relative">
                            <div class="memo-img-wrap">
                                <a href="{{ url_for('public.detail', memo_id=row.memo.id) }}"
                                    class="text-decoration-none">
                                    <img src="{{ url_for('static', filename='images/memo/' ~ memo.image_filename) }}"
                                        alt="Ë®ò‰∫ãÁîªÂÉè"
                                        width=""
                                        height="">
                                </a>
                            </div>
                            <div class="col p-4 d-flex flex-column position-static">
                                <strong class="d-inline-block mb-2">{{ memo.user.username }}</strong>
                                <h3 class="mb-0 text-white">{{ memo.title }}</h3>
                                <div class="mb-1 text-body-secondary">
                                    <i class="fa fa-calendar-o"></i> {{ memo.created_at.strftime("%YÂπ¥%mÊúà%dÊó•") }}
                                </div>
                                <p class="card-text mb-auto">{{ memo.content }}</p>
                                {% if current_user.is_authenticated and memo.user_id != current_user.id %}
                                    <div class="like-area" data-memo-id="{{ memo.id }}">
                                        {% if memo.id in favorite_memo_ids %}
                                            <button class="btn-like active" data-action="remove">
                                                ‚ù§Ô∏è <span class="like-count">{{ like_count }}</span>
                                            </button>
                                        {% else %}
                                            <button class="btn-like" data-action="add">
                                                ü§ç <span class="like-count">{{ like_count }}</span>
                                            </button>
                                        {% endif %}
                                    </div>
                                {% elif current_user.is_authenticated and memo.user_id == current_user.id %}
                                    <small>‚ù§Ô∏è {{ like_count }} „ÅÑ„ÅÑ„Å≠</small>
                                {% else %}
                                    <a href="{{ url_for('auth.login') }}">‚ù§Ô∏è {{ like_count }} „ÅÑ„ÅÑ„Å≠Ôºà„É≠„Ç∞„Ç§„É≥„Åó„Å¶Ë©ï‰æ°Ôºâ</a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <nav aria-label="Page navigation" class="my-5">
                <ul class="pagination justify-content-center pagination-secondary">
                    <li class="page-item {% if page == 1 %}disabled{% endif %}">
                        <a class="page-link d-flex align-items-center justify-content-center h-100"
                            href="?page={{ page - 1 }}"
                            aria-label="Previous"><i class="fa fa-arrow-left"></i></a>
                    </li>
                    {% for p in range(1, total_pages + 1) %}
                        <li class="page-item {% if p == page %}active{% endif %}">
                            <a class="page-link" href="?page={{ p }}">{{ p }}</a>
                        </li>
                    {% endfor %}
                    <li class="page-item {% if page == total_pages %}disabled{% endif %}">
                        <a class="page-link d-flex align-items-center justify-content-center h-100"
                            href="?page={{ page + 1 }}"
                            aria-label="Next"><i class="fa fa-arrow-right"></i></a>
                    </li>
                </ul>
            </nav>
        </div>
        {% include "public/aside.j2" %}
    </div>
{% endblock content %}

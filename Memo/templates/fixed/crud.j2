{% extends "fixed/base.j2" %}

{% block article_body %}
<h3 class="display-6 mt-5 mb-2"><i class="fa fa-cogs"></i>å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¾ã¨ã‚</h3>
<p>åŸºæœ¬çš„ã«ã¯minicondaã§ä½œæˆã—ãŸå„ä»®æƒ³ç’°å¢ƒã”ã¨ã«è¿½åŠ ãŒå¿…è¦</p>
<table class="table table-dark table-striped align-middle">
    <thead>
        <tr>
            <th>ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</th>
			<th>è¿½åŠ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å¿…è¦</th>
			<th style="width: 383px">æ¦‚è¦</th>
		</tr>
	</thead>
<tbody>
<tr>
	<td>Werkzeug</td>
	<td>âŒ Flaskã«å«ã¾ã‚Œã‚‹</td>
	<td style="width: 383px">Flaskã®åœŸå°ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‡¦ç†ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€ãƒ‡ãƒãƒƒã‚°</td>
</tr>
<tr>
	<td>email-validator</td>
	<td>âŒ Flask-WTFã«å«ã¾ã‚Œã‚‹</td>
	<td style="width: 383px">RFC ã«æº–æ‹ ã—ãŸãƒ¡ãƒ¼ãƒ«å½¢å¼ãƒã‚§ãƒƒã‚¯ã‚„ãƒ‰ãƒ¡ã‚¤ãƒ³å­˜åœ¨ç¢ºèª</td>
</tr>
<tr>
	<td>wtforms</td>
	<td>â–³ é€šå¸¸ã¯ä¸è¦</td>
	<td style="width: 383px">ãƒ•ã‚©ãƒ¼ãƒ æ§‹é€ ã‚’å®šç¾©ã€å¿…é ˆ/é•·ã•/å½¢å¼ãªã©å…¥åŠ›å€¤ã®æ¤œè¨¼</td>
</tr>
<tr>
    <td>sqlalchemy</td>
    <td>â–³ é€šå¸¸ã¯ä¸è¦</td>
    <td style="width: 383px">SQLã‚’ç›´æ¥æ›¸ã‹ãšã‚¯ãƒ©ã‚¹ã¨DBã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ãƒ‡ãƒ¼ã‚¿æ“ä½œ</td>
</tr>
<tr>
    <td><strong>flask-wtf</strong></td>
    <td>â­• å¿…è¦</td>
    <td style="width: 383px">ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ•ã‚©ãƒ¼ãƒ ã®é€£æºç®¡ç†ã€CSRFå¯¾ç­–è‡ªå‹•åŒ–</td>
</tr>
<tr>
    <td><strong>flask-sqlalchemy</strong></td>
    <td>â­• å¿…è¦</td>
    <td style="width: 383px">Flaskã®è¨­å®šã¨SQLAlchemyã‚’çµ±åˆã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†è‡ªå‹•åŒ–</td>
</tr>
<tr>
    <td><strong>flask-migrate</strong></td>
    <td>â­• å¿…è¦</td>
    <td style="width: 383px">Alembicã‚’Flaskå‘ã‘ã«çµ±åˆã€ãƒ¢ãƒ‡ãƒ«å¤‰æ›´ã‚’DBã«å®‰å…¨ã«åæ˜ </td>
</tr>
<tr>
    <td><strong>djlint</strong></td>
    <td>â­• é–‹ç™ºç”¨é€”ã§ä½¿ç”¨</td>
    <td style="width: 383px">Flask ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ§‹æ–‡ãƒã‚§ãƒƒã‚¯å“è³ªå‘ä¸Š</td>
</tr>
</tbody>
</table>
<pre class="file-tag" data-tag="console"><code>[ ãƒ–ãƒ©ã‚¦ã‚¶ ]
â†“
[ Flask ]
â”œâ”€ Werkzeug        â† HTTP/WSGIåŸºç›¤
â”œâ”€ flask-wtf
â”‚     â””â”€ wtforms
â”‚           â””â”€ email-validator
â”œâ”€ flask-sqlalchemy
â”‚     â””â”€ sqlalchemy
â””â”€ flask-migrate   â† DBå±¥æ­´ç®¡ç†

[ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ ]
â””â”€ djlint</code></pre>
<h3 class="display-6 mt-5 mb-2"><i class="fa fa-cogs"></i>æœ€çŸ­ç’°å¢ƒæ§‹ç¯‰</h3>
<p>2026å¹´1æœˆæ™‚ç‚¹ã§ã¯2025-08-19ãƒªãƒªãƒ¼ã‚¹ã®<strong>Flask</strong>ã®æœ€æ–°å®‰å®šç‰ˆã¯ã€Œ<mark class="highlight-red"><strong>3.1.2</strong></mark>ã€ã€‚Flaskã¨Pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¿‘ã„ã®ã§æ··ä¹±ã—ã‚„ã™ã„ãŒã€<strong>Python</strong>ã®å¯¾å¿œãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯2ç³»ã¯3.7ã¾ã§ã€3ç³»ã¯ã€Œ<mark class="highlight-red"><strong>3.9</strong></mark>ã€ä»¥é™ãŒã‚µãƒãƒ¼ãƒˆå¯¾è±¡ã€‚<strong>Python</strong>ã®å®‰å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ã€Œ<mark
class="highlight-red"><strong>3.11</strong></mark>ã€ã§ã€Œ3.13ã€ä»¥ä¸Šã ã¨flask-loginã€flask-adminã‚„WerkzeugãŒæœªå¯¾å¿œã®å ´åˆã‚‚ã‚ã‚Šã€å¿…è¦ã«å¿œã˜ã¦ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã€‚</p>
<pre class="file-tag" data-tag="console"><code># æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ¯ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install flask flask-wtf flask-sqlalchemy flask-migrate djlint</code></pre>
<h2>â– åŸºæœ¬Todo</h2>
<pre class="file-tag" data-tag="console"><code>conl            # conda env list
conc Todo       # conda create python=3.11 -n
cona Todo       # conda activate
pipa            # pip install flask flask-wtf flask-sqlalchemy flask-migrate djlint
flv             # flask --version
# Python 3.11.9
# Flask 3.1.2
# Werkzeug 3.1.4

# åŸºæœ¬ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ãƒ¬æ§‹ç¯‰
mkdir -p templates static/css &amp;&amp; \
t app.py templates/base.j2 templates/index.j2 templates/new_task.j2 static/css/style.css &amp;&amp; \
c app.py templates/base.j2 templates/index.j2 templates/new_task.j2 static/css/style.css

[ Todo ]
â”œâ”€ ğŸ“static
â”‚     â””â”€ ğŸ“css
â”‚           â””â”€ ğŸ“„style.css
â”œâ”€ ğŸ“templates
â”‚     â”œâ”€ ğŸ“„index.j2
â”‚     â””â”€ ğŸ“„new_task.j2
â””â”€ ğŸ“„app.py</code></pre>
<pre class="file-tag" data-tag="app.py"><code>import os
from flask import Flask, render_template, request, redirect, url_for
from flask_sqlalchemy import SQLAlchemy
from flask_migrate import Migrate
app = Flask(__name__)
app.config[&#x27;SECRET_KEY&#x27;] = os.urandom(24)
base_dir = os.path.dirname(__file__)
database = &#x27;sqlite:///&#x27; + os.path.join(base_dir, &#x27;data.sqlite&#x27;)
app.config[&#x27;SQLALCHEMY_DATABASE_URI&#x27;] = database
app.config[&#x27;SQLALCHEMY_TRACK_MODIFICATIONS&#x27;] = False
db = SQLAlchemy(app)
Migrate(app, db)

class Task(db.Model):
    __tablename__ = &#x27;tasks&#x27;
    id = db.Column(db.Integer, primary_key=True, autoincrement=True)
    content = db.Column(db.String(200), nullable=False)
    is_completed = db.Column(db.Boolean, default=False)
    def __str__(self):
    return f&#x27;èª²é¡ŒIDï¼š{self.id} å†…å®¹ï¼š{self.content}&#x27;

@app.route(&#x27;/&#x27;)
def index():
    uncompleted_tasks = Task.query.filter_by(is_completed=False).all()
    completed_tasks = Task.query.filter_by(is_completed=True).all()
    return render_template(&#x27;index.j2&#x27;, uncompleted_tasks=uncompleted_tasks, completed_tasks=completed_tasks)

@app.route(&#x27;/new&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])
def new_task():
    if request.method == &#x27;POST&#x27;:
        # POSTã‚¢ã‚¯ã‚»ã‚¹ã§ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰contentã‚’å—ã‘ã€Taskãƒ¢ãƒ‡ãƒ«ã«è¿½åŠ å¾Œä¸€è¦§ãƒšãƒ¼ã‚¸ã¸
        content = request.form[&#x27;content&#x27;]
        task = Task(content=content)
        db.session.add(task)
        db.session.commit()
        return redirect(url_for(&#x27;index&#x27;))
    # GETã‚¢ã‚¯ã‚»ã‚¹æ™‚ã¯æ–°è¦èª²é¡Œä½œæˆãƒšãƒ¼ã‚¸ã¸
    return render_template(&#x27;new_task.j2&#x27;)

@app.route(&#x27;/tasks/&lt;int:task_id&gt;/complete&#x27;, methods=[&#x27;POST&#x27;])
def complete_task(task_id):
    task = Task.query.get(task_id)
    # task_idã‚’å—ã‘å®Œäº†æ¸ˆã¿ã«åˆ‡ã‚Šæ›¿ãˆã¦æ›´æ–°
    task.is_completed = True
    db.session.commit()
    return redirect(url_for(&#x27;index&#x27;))

@app.route(&#x27;/tasks/&lt;int:task_id&gt;/uncomplete&#x27;, methods=[&#x27;POST&#x27;])
def uncomplete_task(task_id):
    task = Task.query.get(task_id)
    # task_idã‚’å—ã‘æœªå®Œäº†ã«åˆ‡ã‚Šæ›¿ãˆã¦æ›´æ–°
    task.is_completed = False
    db.session.commit()
    return redirect(url_for(&#x27;index&#x27;))

if __name__ == &#x27;__main__&#x27;:
app.run()</code></pre>
<p><code>ctrl + k M</code>ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’HTMLã«å¤‰æ›´ã—ã€ä¸€åº¦HTMLã‚¿ã‚°ã ã‘å…ˆã«è¨˜è¿°ã‚’çµ‚ãˆã‚‹ã€‚å†åº¦ã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’<code>jinja html</code>ã«å¤‰æ›´ã—Jinjaã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¿ã‚°ã‚’è¿½è¨˜ã—ã¦ã„ãã€‚ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®æ•´å½¢ã¯<code>Alt + Shift + F</code>ã ãŒãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã®æ§‹æˆã‚’èã‹ã‚ŒãŸå ´åˆã¯<code>djlint</code>ã‚’é¸æŠã™ã‚‹ã€‚</p>
<pre class="file-tag" data-tag="templates/.j2"><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;ja&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;UTF-8&quot;&gt;
        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
        &lt;title&gt;&#123;&#37; block title &#37;&#125;ã‚¿ã‚¤ãƒˆãƒ«&#123;&#37; endblock title &#37;&#125;&lt;/title&gt;
        &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;
        &lt;meta name=&quot;keywords&quot; content=&quot;&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;css/style.css&#x27;) &#125;&#125;&quot;&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;container&quot;&gt;
        &#123;&#37; block content &#37;&#125;
            &lt;h1&gt;å†…å®¹&lt;/h1&gt;
        &#123;&#37; endblock content &#37;&#125;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
<ul class="list-group my-3">
    <li class="list-group-item">â‘  indexã‹ã‚‰æ¸¡ã•ã‚ŒãŸ<code>uncompleted_tasks</code>ã¨<code>completed_tasks</code>ã‚’å­˜åœ¨ã™ã‚‹ã ã‘ç¹°ã‚Šè¿”ã—å‡ºåŠ›</li>
    <li class="list-group-item">â‘¡ æ–°è¦ä½œæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚‰new_taskã¸GETç§»å‹•</li>
    <li class="list-group-item">â‘£ è¿½åŠ ã•ã‚ŒãŸèª²é¡Œã®å®Œäº†ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨<code>complete_task</code>ã«<code>task_id</code> ã‚’ä»˜ä¸ã—ã¦POSTé€ä¿¡</li>
</ul>
<pre class="file-tag" data-tag="templates/index.j2"><code>&#123;&#37; extends &quot;base.j2&quot; &#37;&#125;
&#123;&#37; block title &#37;&#125;èª²é¡Œä¸€è¦§&#123;&#37; endblock title &#37;&#125;
&#123;&#37; block content &#37;&#125;
    &lt;a href=&quot;&#123;&#123; url_for(&#x27;new_task&#x27;) &#125;&#125;&quot; class=&quot;button&quot;&gt;æ–°è¦ä½œæˆ&lt;/a&gt;
    &lt;hr&gt;
    &lt;h2 class=&quot;no-complete&quot;&gt;æœªå®Œäº†ï¼šèª²é¡Œä¸€è¦§&lt;/h2&gt;
    &lt;ul&gt;
        &#123;&#37; for task in uncompleted_tasks &#37;&#125;
            &lt;li&gt;
                &lt;p&gt;&#123;&#123; task.content &#125;&#125;&lt;/p&gt;
                &lt;form action=&quot;&#123;&#123; url_for(&#x27;complete_task&#x27;, task_id=task.id) &#125;&#125;&quot; method=&quot;post&quot; novalidate&gt;
                    &lt;button type=&quot;submit&quot; class=&quot;complete-button&quot;&gt;å®Œäº†&lt;/button&gt;
                &lt;/form&gt;
            &lt;/li&gt;
        &#123;&#37; endfor &#37;&#125;
    &lt;/ul&gt;
    &lt;hr&gt;
    &lt;h2 class=&quot;complete&quot;&gt;å®Œäº†æ¸ˆã¿ï¼šèª²é¡Œä¸€è¦§&lt;/h2&gt;
    &lt;ul&gt;
        &#123;&#37; for task in completed_tasks &#37;&#125;
            &lt;li&gt;
                &lt;p&gt;&#123;&#123; task.content &#125;&#125;&lt;/p&gt;
                &lt;form action=&quot;&#123;&#123; url_for(&#x27;uncomplete_task&#x27;, task_id=task.id) &#125;&#125;&quot; method=&quot;post&quot; novalidate&gt;
                    &lt;button type=&quot;submit&quot; class=&quot;uncomplete-button&quot;&gt;å®Œäº†&lt;/button&gt;
                &lt;/form&gt;
            &lt;/li&gt;
        &#123;&#37; endfor &#37;&#125;
    &lt;/ul&gt;
&#123;&#37; endblock content &#37;&#125;</code></pre>
<p>â‘¢POSTé€ä¿¡ã§contentã®ã¿é€ä¿¡</p>
<pre class="file-tag" data-tag="templates/new_task.j2"><code>&#123;&#37; extends &#x27;base.j2&#x27; &#37;&#125;
&#123;&#37; block title &#37;&#125;æ–°è¦èª²é¡Œ&#123;&#37; endblock title &#37;&#125;
&#123;&#37; block content &#37;&#125;
    &lt;h1&gt;æ–°è¦èª²é¡Œ&lt;/h1&gt;
    &lt;form action=&quot;&#123;&#123; url_for(&#x27;new_task&#x27;) &#125;&#125;&quot; method=&quot;post&quot; novalidate&gt;
        &lt;label&gt;èª²é¡Œå†…å®¹
            &lt;input type=&quot;text&quot; id=&quot;content&quot; name=&quot;content&quot; class=&quot;text-input&quot;&gt;
        &lt;/label&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; class=&quot;button&quot; value=&quot;è¿½åŠ &quot;&gt;
    &lt;/form&gt;
&#123;&#37; endblock content &#37;&#125;
</code></pre>
<pre class="file-tag" data-tag="static/css/style.css"><code>@charset &#x27;UTF-8&#x27;;

.container &#123;
  background-color: #f8f8f8;
  min-width: 800px;
  padding: 20px;
  font-family: Arial, Helvetica, sans-serif;
&#125;

h1 &#123;
  color: #333;
  text-align: center;
  margin-top: 50px;
&#125;

li &#123;
  padding-left: 0;
  display: block;
&#125;

label &#123;
  font-size: 20px;
&#125;

.no-complete &#123;
  color: green;
&#125;

.complete &#123;
  color: red;
&#125;

.button &#123;
  background-color: blue;
  border: none;
  color: white;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
  margin-bottom: 20px;
&#125;

a.button &#123;
  display: block;
  width: 200px;
&#125;

.complete-button, .uncomplete-button &#123;
  background-color: green;
  border: none;
  color: white;
  padding: 5px 10px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
&#125;

.uncomplete-button &#123;
  background-color: red;
&#125;

ul &#123;
  list-style-type: none;
  margin: 0;
  padding: 0;
&#125;

div &#123;
  background-color: white;
  border: 1px solid #ccc;
  margin-bottom: 10px;
  padding: 10px;
&#125;

p &#123;
  font-size: 20px;
&#125;

.text-input &#123;
  padding: 10px;
  width: 80px;
  background-repeat: 5px;
  border: 1px solid #ccc;
  margin: 10px;
&#125;
</code></pre>
<pre class="file-tag" data-tag="console"><code># SQLiteã«tasksãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
flask db init
flask db migrate -m &quot;create tasks table&quot;
flask db upgrade

flr             # flask run --debug
</code></pre>
{% endblock article_body %}

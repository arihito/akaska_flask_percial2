<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Swiper demo</title>
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1"
        />
        <!-- Link Swiper's CSS -->
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
        />

        <!-- Demo styles -->
        <style>
            @import url("https://fonts.googleapis.com/css2?family=WDXL+Lubrifont+JP+N&display=swap");

            html,
            body {
                position: relative;
                height: 100%;
            }

            body {
                background: #000;
                font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
                font-size: 14px;
                color: #fff;
                margin: 0;
                padding: 0;
            }

            body {
                background: #fff;
                font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
                font-size: 14px;
                color: #000;
                margin: 0;
                padding: 0;
            }

            html,
            body {
                position: relative;
                height: 100%;
            }

            body {
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .swiper {
                width: 40vw;
                height: 40vw;
            }

            .swiper-slide {
                display: flex;
                justify-content: center;
                align-items: center;
                border-radius: 18px;
                box-shadow: 0 1px 3px gray;
                border: 10px solid white;
                background: #eee center 80% / 40% no-repeat;
            }
            .swiper-text {
                padding-top: 15vh;
                font-size: 8rem;
                font-weight: bold;
                font-family: "WDXL Lubrifont JP N", sans-serif;
                font-weight: 400;
                font-style: normal;
                color: #ccc;
                text-align: center;
                text-shadow: 0 1px 6px white;
                line-height: 0.6;
            }
            .slide-inner {
                width: 100%;
                height: 100%;
                border-radius: 18px;
                box-shadow: 0 1px 3px gray;
                border: 10px solid white;
                background: #eee center 80% / 40% no-repeat;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .swiper-slide span {
                font-size: 3rem;
                letter-spacing: 1px;
            }
            .swiper-btn {
                font-size: 2rem;
                color: #aaa;
                padding: 10px 20px;
                border-radius: 5px;
                border: 1px solid #ccc;
                box-shadow: 0 1px 1px #aaa;
            }
            .swiper-btn:hover {
                box-shadow: inset 0 1px 1px #aaa;
            }

            .swiper-slide:nth-child(1n) .slide-inner {
                background-image: url("img/sources/01.png");
            }

            .swiper-slide:nth-child(2n) .slide-inner {
                background-image: url("img/sources/02.png");
            }

            .swiper-slide:nth-child(3n) .slide-inner {
                background-image: url("img/sources/03.png");
            }

            .swiper-slide:nth-child(4n) .slide-inner {
                background-image: url("img/sources/04.png");
            }

            .swiper-slide:nth-child(5n) .slide-inner {
                background-image: url("img/sources/05.png");
            }

            .swiper-slide:nth-child(6n) .slide-inner {
                background-image: url("img/sources/06.png");
            }

            .swiper-slide:nth-child(7n) .slide-inner {
                background-image: url("img/sources/07.png");
            }

            .swiper-slide:nth-child(8n) .slide-inner {
                background-image: url("img/sources/08.png");
            }

            .swiper-slide:nth-child(9n) .slide-inner {
                background-image: url("img/sources/09.png");
            }

            .swiper-slide:nth-child(10n) .slide-inner {
                background-image: url("img/sources/10.png");
            }
        </style>
        <!-- /* 上の候補 */
            .block-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
                gap: 12px;
                margin-bottom: 32px;
            }

            .block-grid li {
                height: 100px;
                border: 2px solid #333;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
            }

            /* 下のペア全体 */
            .pair-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
                gap: 16px;
            }

            /* wrapper：縦方向を保証 */
            .pair-wrapper {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }

            /* pending */
            .pending-box {
                height: 80px;
                border: 2px dashed #999;
                color: #999;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
            }

            /* pair 本体 */
            .pair {
                display: flex;
                gap: 8px;
            }

            .item {
                flex: 1;
                height: 100px;
                border: 2px solid #555;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
            }

            /* ＋ */
            .plus-btn {
                width: 40px;
                font-size: 20px;
                cursor: pointer;
            } -->
    </head>

    <body>
        <div class="swiper mySwiper">
            <div class="swiper-wrapper" id="source-list">
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="ポン酢">
                        <div class="swiper-text">
                            ポン酢<br />
                            <span>Ponzu</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="にんにく醤油">
                        <div class="swiper-text">
                            にんにく醤油<br />
                            <span>Garlic Soy Sauce</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="わさび醤油">
                        <div class="swiper-text">
                            わさび醤油<br />
                            <span>Wasabi Soy Sauce</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="醤油バター">
                        <div class="swiper-text">
                            醤油バター<br />
                            <span>Soy Sauce Butter</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="ガーリックバター">
                        <div class="swiper-text">
                            ガーリックバター<br />
                            <span>Garlic Butter</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="照り焼き">
                        <div class="swiper-text">
                            照り焼き<br />
                            <span>Teriyaki </span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="焼肉のたれ">
                        <div class="swiper-text">
                            焼肉のたれ<br />
                            <span>BBQ Sauce</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="三杯酢">
                        <div class="swiper-text">
                            三杯酢<br />
                            <span>Vinegar Soy Dipping Sauce</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="柚子胡椒">
                        <div class="swiper-text">
                            柚子胡椒<br />
                            <span>Yuzu Kosho</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="生姜ポン酢">
                        <div class="swiper-text">
                            生姜ポン酢<br />
                            <span>Ginger Ponzu</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="ホワイトソース">
                        <div class="swiper-text">
                            ホワイトソース<br />
                            <span>White Sauce</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="デミグラス">
                        <div class="swiper-text">
                            デミグラス<br />
                            <span>Demi-glace</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="マスタードハニー">
                        <div class="swiper-text">
                            マスタードハニー<br />
                            <span>Honey Mustard</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="黒ゴマ">
                        <div class="swiper-text">
                            黒ゴマ<br />
                            <span>Black Sesame</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="ゴマ味噌">
                        <div class="swiper-text">
                            ゴマ味噌<br />
                            <span>Sesame Miso</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="ごま油ネギ塩">
                        <div class="swiper-text">
                            ごま油ネギ塩<br />
                            <span>Green Onion Salt</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="豆板醤">
                        <div class="swiper-text">
                            豆板醤<br />
                            <span>Chili Bean Paste</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="オイスター">
                        <div class="swiper-text">
                            オイスター<br />
                            <span>Oyster Sauce</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="スイートチリ">
                        <div class="swiper-text">
                            スイートチリ<br />
                            <span>Sweet Chili Sauce</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="ナンプラーレモン">
                        <div class="swiper-text">
                            ナンプラーレモン<br />
                            <span>Fish Sauce & Lemon</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="オリーブレモン">
                        <div class="swiper-text">
                            オリーブレモン<br />
                            <span>Olive Oil & Lemon</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="花椒ラー油">
                        <div class="swiper-text">
                            花椒ラー油<br />
                            <span>Sichuan Pepper Chili Oil</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="甘辛コチュジャン">
                        <div class="swiper-text">
                            甘辛コチュジャン<br />
                            <span>Sweet & Spicy Gochujang</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="味噌コチュジャン">
                        <div class="swiper-text">
                            味噌コチュジャン<br />
                            <span>Miso Gochujang</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="ケイジャンバター">
                        <div class="swiper-text">
                            ケイジャンバター<br />
                            <span>Cajun Butter</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="黒酢にんにく">
                        <div class="swiper-text">
                            黒酢にんにく<br />
                            <span>Black Vinegar Garlic</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="シーザー">
                        <div class="swiper-text">
                            シーザー<br />
                            <span>Caesar Dressing</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="バルサミコ">
                        <div class="swiper-text">
                            バルサミコ<br />
                            <span>Balsamic Sauce</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="和風オニオン">
                        <div class="swiper-text">
                            和風オニオン<br />
                            <span>Onion Sauce</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="slide-inner" data-name="カレーヨーグルト">
                        <div class="swiper-text">
                            カレーヨーグルト<br />
                            <span>Curry Yogurt</span>
                        </div>
                    </div>
                </div>
            </div>
            <div id="selected-list" class="pair-grid"></div>
        </div>

        <!-- Swiper JS -->
        <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

        <!-- Initialize Swiper -->
        <script>
            var swiper = new Swiper(".mySwiper", {
                effect: "cards",
                grabCursor: true,
            });
            const source = document.getElementById("source-list");
            const selected = document.getElementById("selected-list");

            const MAX_PAIR = 3;
            let pending = null;

            /* 上から下へ */
            source.addEventListener("click", (e) => {
                const slide = e.target.closest(".swiper-slide");
                if (!slide) return;

                if (pending) {
                    addSecondItem(pending.wrapper, slide);
                    clearPending();
                    return;
                }

                if (selected.children.length >= MAX_PAIR) return;

                const wrapper = createPairWrapper(slide);
                selected.appendChild(wrapper);
            });

            /* 下の操作 */
            selected.addEventListener("click", (e) => {
                /* ＋ */
                if (e.target.classList.contains("plus-btn")) {
                    if (pending) return;
                    showPending(e.target.closest(".pair-wrapper"));
                    return;
                }

                /* pending キャンセル */
                if (e.target.classList.contains("pending-box")) {
                    clearPending();
                    return;
                }

                /* item クリック */
                if (e.target.classList.contains("item")) {
                    const wrapper = e.target.closest(".pair-wrapper");
                    const items = wrapper.querySelectorAll(".item");

                    // 1個目クリック → 上に戻す
                    if (items[0] === e.target) {
                        returnItemToSource(e.target);
                        wrapper.remove();
                        clearPending();
                    }

                    // 2個目クリック → キャンセル
                    if (items[1] === e.target) {
                        returnItemToSource(e.target);
                        wrapper.querySelector(".plus-btn")?.remove();
                        wrapper
                            .querySelector(".pair")
                            .appendChild(createPlus());
                    }
                }
            });

            /* ---------- helpers ---------- */

            function createPairWrapper(li) {
                const wrapper = document.createElement("div");
                wrapper.className = "pair-wrapper";

                const pair = document.createElement("div");
                pair.className = "pair";

                pair.appendChild(createItem(li));
                pair.appendChild(createPlus());

                wrapper.appendChild(pair);
                return wrapper;
            }

            function createItem(slide) {
                const div = document.createElement("div");
                div.className = "item";
                div.textContent =
                    slide.querySelector(".slide-inner")?.dataset.name ||
                    slide.querySelector(".swiper-text")?.dataset.name;
                slide.remove(); // ← swiper-slide 1枚だけ消える
                return div;
            }

            function createPlus() {
                const btn = document.createElement("button");
                btn.className = "plus-btn";
                btn.textContent = "+";
                return btn;
            }

            function showPending(wrapper) {
                const box = document.createElement("div");
                box.className = "pending-box";
                box.textContent = "選択してください（クリックでキャンセル）";
                wrapper.prepend(box);
                pending = { wrapper, box };
            }

            function clearPending() {
                if (!pending) return;
                pending.box.remove();
                pending = null;
            }

            function addSecondItem(wrapper, li) {
                const pair = wrapper.querySelector(".pair");
                pair.appendChild(createItem(li));
                pair.querySelector(".plus-btn")?.remove();
            }

            function returnItemToSource(item) {
                const li = document.createElement("li");
                li.dataset.name = item.textContent;
                li.textContent = item.textContent;
                source.appendChild(li);
            }
        </script>
    </body>
</html>
